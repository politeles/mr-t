%
% Fuzzy temporal databases
%
Consider a logistics company which transports packages. At the moment a package leaves, the time when it will arrive at its destination may be estimated, but will typically not be known precisely. For such companies and in many other situations, information systems able to handle imperfection with respect to certain temporal aspects of the objects modelled by the system are necessary.

\subsection{Data Imperfections in Temporal Databases}

%The time when a package would arrive at its destination may be estimated and can eventually be researched, but it is typically not always precisely known. For such companies and in many other situations, information systems able to handle imperfection corresponding to certain temporal aspects of the objects modelled by the system are necessary. The transition between granularities~\cite{Lin97} is also sometimes considered as a source of imprecision. Therefore, some proposals consider granularity as the base of the temporal model~\cite{Cru97}.
%Some software applications deal with uncertainty related to time. e.g. a logistics company which transports packages from one destination to another. The time when the package would be at the end point may be estimated but not precisely known. These applications need to manage the uncertainty with respect to the temporal attributes of the objects stored in the database.

Data and information imperfections and techniques to represent them correctly in databases and queries are usually the focus of research in fuzzy databases. Proposals from this field may present an approach based somehow on fuzzy set theory~\cite{Zadeh65} or possibility theory~\cite{Dubois:Prade:1988:PossibilityTheory}, although other theories support information imperfections too. Comparably, many proposals concerning the introduction of data imperfections or information imperfections in temporal databases present approaches based somehow on fuzzy set theory~\cite{garrido2009},~\cite{gal01},~\cite{nagypal2003},~\cite{Billiet:Pons:Matthe:DeTre:Pons:2011:BipolarFuzzy} or possibility theory~\cite{Dubois89},~\cite{Pon11},~\cite{129895}, although proposals based on other theories exist~\cite{Dyreson1998},~\cite{Dekhtyar2001},~\cite{Qia09}. As possibility theory is usually seen as a theory of confidence, aimed at dealing with uncertainty, in some proposals, possibility theory is used specifically to handle uncertainty in temporal information. In fuzzy databases~\cite{Galindo2006}, uncertainty is usually expected to appear in the database content, whereas other types of imperfection, notably imprecision, are usually expected to appear in querying. 

Concerning temporal databases, there are several approaches to handle uncertainty in temporal data stored in a database. Many of these approaches concern several different types of time notions (VT, TT or DT), but most of these approaches focus somehow on valid time~\cite{garrido2009},~\cite{gal01}.

In the following subsection, a novel approach to representing uncertainty concerning valid time notions and a corresponding technique to query similar valid time indications in a valid-time relation are proposed. The presented proposal is based on concepts introduced in~\cite{Dubois88b} and on the framework proposed in~\cite{Pon11}.

\subsection{Handling Uncertainty in a Valid-time Relation}
A valid time indication usually takes the form of a time interval. Such a valid time interval can be described (and stored in a valid time relation record) using its boundaries (endpoints) or using one endpoint and the interval length. Usually, a valid-time interval is represented using its endpoints, which is also the approach adopted by the presented proposal. 

Generally, the uncertainty concerning a set of values might be described by a possibility distribution on the powerset of which one of the elements can be the intended set~\cite{Dubois88b}. This representation, however, introduces some issues in practice or in practical applications. Therefore, in the presented proposal, possibility theory is used to model uncertainty, but only uncertainty concerning the exact values of the start and end point of a valid-time interval is considered and the uncertainty in both the start point and the end point are modelled using possibility distributions.

In fact, to model the uncertainty related to a valid-time interval using possibility theory, the presented proposal introduces so-called ill-known time intervals, relying on the concept of ill-known sets~\cite{Dubois88b}.

%Some models consider probability~\cite{Dekhtyar2001} or possibility~\cite{Dubois89} distributions to describe the endpoints of a time interval. In this section, we will present a novel and currently researched technique to describe valid-time interval start- and endpoints using possibility distributions. In subsection \ref{subsec:representation-time-intervals} we will present an approach to modelling uncertainty in valid-time intervals. Finally, in subsection \ref{subsec:querying-time-intervals} the proposals for querying valid-time intervals in a flexible way are presented and discussed.%In this section we will explain the most interesting proposals that deal with possibility distributions in the valid-time interval. %Two are the main points developed within this section: the representation of uncertainty in the time interval and the flexible querying of ill-known time periods.

%In fuzzy databases~\cite{Galindo2006}, uncertainty is managed at storage level whereas imprecision is managed at querying level. In subsection \ref{subsec:representation-time-intervals} we will explain the main approach for the storage of uncertainty in the valid-time interval. Finally, in subsection \ref{subsec:querying-time-intervals} the proposals for querying in a flexible way valid-time intervals are analyzed.


\subsubsection{Ill-known Time Intervals}
\label{subsec:representation-time-intervals}
%Uncertainty in a valid-time interval may be modelled by modelling the uncertainty concerning the exact start, respectively end point of the valid-time interval. The uncertainty concerning these points can by modelled by means of possibility distributions. It is of course also possible to use rough sets~\cite{Pawlak1995} for this modelling~\cite{Qia09}. The work presented in this section relies on possibilistic variables, which rely on possibility theory \cite{Dubois:Prade:1988:PossibilityTheory}.

To represent valid time indications which might contain uncertainty, the presented proposal introduces the concept of ill-known valid time intervals, which relies on the concept of ill-known sets~\cite{Dubois88b}. To correctly explain the concept of ill-known sets, the concept of possibilistic variables should be introduced first. In the presented proposal, the definition of possibilistic variables of~\cite{Pon11} is followed. In~\cite{Pon11}, a \emph{possibilistic variable} is defined as follows.

\begin{svgraybox}
\vspace{-10pt}
\begin{definition}
A possibilistic variable $X$ over a universe $U$ is defined as a variable taking exactly one value in $U$, but for which this value is (partially) unknown. Its possibility distribution $\pi_X$ on $U$ models the available knowledge about the value that $X$ takes: for each $u\in U$, $\pi_X(u)$ represents the possibility that $X$ takes the value $u$. In the presented work, this possibility is interpreted as a measure of how plausible it is that $X$ takes the value $u$, given (partial) knowledge about the value $X$ takes.
\end{definition}
\vspace{-10pt}
\end{svgraybox}


Now, consider a set $R$, which contains single values (and not collections of values). When a possibilistic variable $X_{v}$ is defined on such a set $R$, the unique value $X_{v}$ takes, which is (partially) unknown, is called an \emph{ill-known value} in this work \cite{Dubois88b}.

When a possibilistic variable is defined on the powerset $\Pow(R)$ of some universe $R$, the unique value the variable takes will be a crisp set and its possibility distribution on the powerset $\Pow(R)$ will describe the possibility of each crisp subset of $R$ to be the value the variable takes. This value (a crisp set) the variable takes, which is (partially) unknown, is now called an \emph{ill-known set} \cite{Dubois88b}.

Finally, consider a set $R$, which contains single values (and not collections of values) and its powerset $\Pow(R)$. Now consider a subset $\Pow_{I}(R)$ of $\Pow(R)$ and let this subset contain every element of $\Pow(R)$ that is an interval, but no other elements. When a possibilistic variable $X_{i}$ is defined on the subset $\Pow_{I}(R)$ of the powerset $\Pow(R)$ of some set $R$, the unique value $X_{i}$ takes will be a crisp interval and the possibility distribution $\pi_{X_{i}}$ of $X_{i}$ will be a possibility distribution on $\Pow_{I}(R)$. This $\pi_{X_{i}}$ will define the possibility of each value of $\Pow_{I}(R)$ (a value of $\Pow_{I}(R)$ is a crisp interval which is a subset of $R$) being the value $X_{i}$ takes. This exact value (a crisp interval) the variable takes, which is (partially) unknown, is called an \emph{ill-known interval} here.

The presented proposal will deal with ill-known time intervals. Ill-known time intervals are ill-known intervals in a time domain. In the presented proposal, an ill-known time interval will be defined and represented via its start and end point, which will be ill-known values. The elements of the ill-known time interval are the values between its start and end point, including the start and end points themselves\footnote{The presented proposal only deals with closed ill-known time intervals. Dealing with halfopen or open ill-known intervals is part of the current research of the authors.}. It should be clear that this approach to representing ill-known time intervals differs from the approach based on a single possibility distribution on a set $\Pow_{I}(R)$ of a set $R$. These approaches have a different behavior and can be used to describe different ill-known time intervals. The correspondences, interactions and transitions between these different representations of ill-known intervals and their interpretations are part of the authors current research.

In the presented proposal, a closed ill-known time interval with start point defined by possibilistic variable $X$ and end point by possibilistic variable $Y$ is noted $\left[X, Y\right]$. Figure \ref{fig:interval} shows a closed ill-known time interval. %The correspondences and transitions between the representations of ill-known sets, between the representations of ill-known intervals and between the representations of an ill-known set and an ill-known interval are part of the authors current research. Figure \ref{fig:interval} illustrates this.


\begin{figure}
\centering
\input{graphs/interval.tex}
\caption{A closed ill-known time interval $\left[X, Y\right]$, where triangular possibility distributions describe the ill-known values defining the start and end points.}
\label{fig:interval}
\end{figure}

%Uncertainty in a valid-time interval may be modelled with uncertainty at one or both starting and ending points. The uncertainty is usually represented by means of a possibility distribution in one or both points. It is also possible to represent with rough sets~\cite{Pawlak1995} time intervals~\cite{Qia09}.

Several authors work with concepts very similar to these ill-known time intervals and some of them~\cite{garrido2009} propose transformations of the describing functions in order to optimize the storage of such ill-known valid time intervals, though recent research might seem to indicate some minor issues with respect to some of these transformations~\cite{Pon11}. A comparison between the transformations in~\cite{garrido2009} and the framework in~\cite{Pon11} is presented in~\cite{pon12}. Figure \ref{fig:convexhull} illustrates a transformation based on the `convex hull' approach~\cite{garrido2009}.



%An ill-known time interval is usually represented by means of two possibility distributions one in each starting and ending points. Figure \ref{fig:interval} shows an ill-known valid-time interval. The starting and ending points are denoted by two fuzzy numbers, $X$ and $Y$, represented by means of two triangular possibility distributions (see the Appendix). For illustration, figure \ref{fig:convexhull} shows one of the transformations based in the convex hull and proposed in~\cite{garrido2009}.
\begin{figure}
\centering
\input{graphs/convexhull.tex}
\caption{Transformation based in the convex hull from the two ill-known points $X$ and $Y$. }
\label{fig:convexhull}
\end{figure}

%In section \ref{subsec:querying-time-intervals}, a technique allowing the querying of fuzzy valid-time databases which contain ill-known valid-time intervals is presented and briefly explained. The technique relies on the framework for set evaluation presented in \cite{Pon11}.

In the presented proposal, ill-known valid time intervals will be used to represent valid time indications in a valid-time relation and to model the uncertainty these may contain.

To evaluate the temporal demands in queries issued by users to query a valid-time relation containing ill-known valid time intervals, the presented proposal introduces a technique based on the concept of ill-known time constraints, which is based on the concept of ill-known constraints as presented in~\cite{Pon11}. Both concepts are treated in subsection \ref{iktc}.

Before ill-known time constraints can be introduced, another notion related to possibilistic variables shoud be paid attention to. In fact, a specific application of possibilistic variables is obtained when the set under consideration is the set of boolean values, denoted $\mathbb{B}$ = $\{T,F\}$, where $T$ denotes `true' and $F$ denotes `false' \cite{Pon11}. Indeed, any boolean proposition $p$ takes exactly one value in $\mathbb{B}$. If the knowledge about which value this proposition $p$ takes, is given by a possibility distribution $\pi_p$, then proposition $p$ can be seen as a possibilistic variable. In the presented proposal, the interest lies with the case where the proposition holds (denoted $p$ = $T$) and the possibility and necessity that $p$ = $T$ demand most attention. In the following sections, the following notations are used, based on previous notations:

\begin{align}
\text{Possibility that $p$ = $T$:} \hspace{50pt} & Pos(p) = \pi_p(T) \\
\text{Necessity that $p$ = $T$:} \hspace{50pt} & Nec(p) = 1-\pi_p(F) 
\end{align}


\subsubsection{\label{iktc}Ill-known Time Constraints}
The presented proposal contains a technique for evaluating user queries used to query a valid time relation in which the valid time indications are represented by ill-known time intervals. Part of this query evaluation technique relies on the concept of ill-known time constraints, which is based on the concept of ill-known constraints as presented in~\cite{Pon11}. These concepts are presented below. Following~\cite{Pon11}, an \emph{ill-known constraint} is defined as follows.

\begin{svgraybox}
\vspace{-10pt}
\begin{definition}
Given a universe $U$, an \emph{ill-known constraint} $C$ is specified by means of a binary relation $R \subseteq U^{2}$ and a fixed, ill-known value defined by its possibilistic variable $V$ on $U$, i.e.:
\begin{align}
C \triangleq (V,R) \nonumber
\end{align}
A set $A \subseteq U$ now satisfies this constraint $C$ if and only if:
\begin{align}
\forall a \in A : (V,a) \in R \nonumber
\end{align}
\end{definition}
\vspace{-10pt}
\end{svgraybox}

An example of an ill-known constraint is given by:
\begin{align}
C_{<} \triangleq (X, <) \nonumber
\end{align}
Some set $A$ then satisfies $C_{<}$ if 
\begin{align}
\forall a \in A : X <a \nonumber
\end{align}

The satisfaction of a constraint $C \triangleq (V,R)$ by a set $A$ is basically a Boolean matter (either the set satisfies the constraint or not) and can thus be seen as a boolean proposition, but due to the uncertainty inherent to the ill-known value $V$, it can be uncertain whether $C$ is satisfied by $A$ or not \cite{Pon11}. Based on the possibility distribution $\pi_{V}$ of $V$, the possibility and necessity that $A$ satisfies $C$ can be found. This proposition can thus be seen as a possibilistic variable on $\mathbb{B}$. The required possibility and necessity are calculated using the following formulas~\cite{Pon11}.

\begin{align}
Pos(A\text{ satisfies }C) & = \min_{a \in A}\left(\sup_{(w,a) \in R}\pi_{V}(w))\right) \label{eq:pos}\\
Nec(A\text{ satisfies }C) & = \min_{a \in A}\left(\inf_{(w,a) \notin R} 1-\pi_{V}(w)\right) \label{eq:nec}
\end{align}

Now, to calculate the possibility or necessity of a set $A$ satisfying multiple constraints, the $\min$ t-norm operator is used to express a conjunction of constraints. For example:

\begin{align}
Pos((A\text{ satisfies }C_{1}) \text{ and } (A\text{ satisfies }C_{2})) & = \nonumber\\
 \min_{a \in A}(Pos(A\text{ satisfies }C_{1}), Pos(A\text{ satisfies }C_{2})) \nonumber \\
Nec((A\text{ satisfies }C_{1}) \text{ and } (A\text{ satisfies }C_{2})) & = \nonumber\\
 \min_{a \in A}(Nec(A\text{ satisfies }C_{1}), Nec(A\text{ satisfies }C_{2})) \nonumber
\end{align}

Accordingly, the $\max$ t-conorm operator is used to express a disjunction of constraints. For example:

\begin{align}
Pos((A\text{ satisfies }C_{1}) \text{ or } (A\text{ satisfies }C_{2})) & = \nonumber\\
 \max_{a \in A}(Pos(A\text{ satisfies }C_{1}), Pos(A\text{ satisfies }C_{2})) \nonumber \\
Nec((A\text{ satisfies }C_{1}) \text{ or } (A\text{ satisfies }C_{2})) & = \nonumber\\
 \max_{a \in A}(Nec(A\text{ satisfies }C_{1}), Nec(A\text{ satisfies }C_{2})) \nonumber
\end{align}

%Negation?

In the presented proposal, \emph{ill-known time constraints} are considered, which are ill-known constraints of which the considered universe is a time domain.

In the next subsection, the core of the presented proposal is described. 

\subsubsection{Querying Valid-time Relations containing Ill-known Valid-time Intervals}
\label{subsec:querying-time-intervals}

One of the main purposes of the existence of (relational) databases is to allow information retrieval. The standard query language for (relational) databases is SQL~\cite{Mel93}, but several proposals to extend the SQL language for transaction-time databases~\cite{Sarda90}, valid-time databases~\cite{gad92} and bitemporal databases~\cite{TSQL} exist and some authors have studied how to support temporal querying in standard SQL~\cite{Snodgrass98}.

As mentioned before, the presented proposal deals with querying a valid time relation. In this subsection, the core of the presented proposal is described. First the particular structure of the relation is described, along with the nature and structure of its supposed contents. Next, the particular query structure is presented. Finally, the particular method for evaluating queries and for ranking the result records are presented.


%In the following subsections, the nature and structure of the relation content, the query structure, the query evaluation method and the technique to meaningfully rank and aggregate the query results, proposed in this work, are presented. 

%In the querying of a fuzzy temporal database it is possible to distinguish among the following cases:

%\begin{itemize}
%\item
%Fuzzy data stored in the database and crisp specification in the query.
%\item
%Crisp data stored in the database and fuzzy data in the query specification.
%\item
%Both data stored in the database and the query specification are fuzzy.
%\end{itemize}
%In this subsection we will explain the query specification for a database that stores ill-known time intervals and crisp values in the query. Afterwards, the aggregation and ranking of the temporal results is explained.

\paragraph{\textbf{Relation Structure}}
In the presented proposal, a valid-time relation is considered, in which every record contains just one valid-time indication. This valid-time indication is represented by a closed ill-known time interval, to allow uncertainty in the valid-time information. As explained above, the ill-known time intervals used here will be defined and represented via their start and end points, which are ill-known values in the valid-time domain.

\paragraph{\textbf{Query Structure}}
In the presented proposal, a query consists of two separate constructs of user demands.

%Consider that in a regular or fuzzy relational database, the query specification for the non-temporal attributes is given by $Q$. Therefore, the query specification in a temporal or fuzzy temporal database is given by $\tilde{Q}$:

\begin{svgraybox}
\vspace{-10pt}
\begin{definition}
\textbf{Query}\\
A query $\tilde{Q}$ is given by:
\begin{equation}
\label{eq:query-specification}
\tilde{Q} = \left( Q^{time}, Q \right)
\end{equation}

Here, $Q$ denotes the construct of all (possibly fuzzy) non-temporal user query demands. These comprise all constraints and demands unrelated to valid-time and thus unrelated to the valid-time indications in the queried relation. $Q^{time}$ denotes the temporal demand specified by the user.

%Here $Q = \left \lbrace q_1,\ \cdots,\ q_n \right \rbrace$ contains all (possibly fuzzy) non-temporal user-defined query demands. These comprise all constraints unrelated to the valid-time indications in the queried relations. $Q^{time}$ denotes the temporal constraint specified by the user.
\end{definition}
\vspace{-10pt}
\end{svgraybox}
%%specify better this:
%\begin{svgraybox}
%\begin{definition}
%\label{def:query-constraint}
%\textbf{(query constraint)}
%$Q$ is the 
%A query constraint $q_a$ for an attribute $a$ with attribute domain $\mathcal{D}$, is a restriction in the subset of the values in the attribute domain:
%\begin{equation}
%\label{eq:query-constraint}
%q_a = \left \lbrace d \mid d \subseteq \mathcal{D} \right \rbrace
%\end{equation}
%\end{definition}

The presented query structure allows the user to specify a single temporal demand, denoted by $Q^{time}$.

\begin{svgraybox}
\vspace{-10pt}
\begin{definition}
\textbf{Temporal demand}\\
A temporal demand $Q^{time}$ is defined by:
\begin{equation}
Q^{time} = \left( I,AR \right)
\end{equation}
Here, $I$ denotes a crisp time interval (which can be specified in any way required) and $AR$ denotes one of the Allen relations (cf. section~\ref{allen-crisp}).
\end{definition}
\vspace{-10pt}
\end{svgraybox}

The interpretation of such a temporal demand $Q^{time} = \left( I,AR \right)$ is that, for a record with an ill-known valid-time interval $J$, the user demands that $I$ AR $J$ holds.

\paragraph{\textbf{Query evaluation}}
\label{subsubsec:query-evaluation}
Query satisfaction in a fuzzy relational database is usually a matter of degree. Typically, the evaluation of the query demands for a record results in a \emph{satisfaction degree} $s$, which is typically in the unit interval, i.e. $s \in \left[ 0,1\right]$. This satisfaction degree then models the extent to which the record satisfies the query demands. As such, a satisfaction degree of $0$ indicates total dissatisfaction while a degree of $1$ indicates total satisfaction and every level of satisfaction between total satisfaction and total dissatisfaction is indicated by a satisfaction degre between $0$ and $1$.

%\begin{svgraybox}
%\begin{definition}
%\label{def:evaluation-function}
%\textbf{Evaluation function}
%An evaluation function $e_{Q} \left( r \right)$ is a mapping from the attribute value from the row $r$ in the database with respect to the constraints $Q = \left \lbrace q_1, \cdots, q_n \right \rbrace$ to the unit interval $\left[ 0,1 \right]$. 
%\begin{equation}
%\label{eq:evaluation-function} 
%e_{Q} = t \mid t \in \left[ 0,1 \right]
%\end{equation}
%\end{definition}
%\end{svgraybox}


In the presented approach, for every record $r$, each part of a query $\tilde{Q} = \left( Q^{time}, Q \right)$ is evaluated independently:
\begin{itemize}
\item
The user preferences expressed in the non-temporal part $Q$, are evaluated, resulting in a satisfaction degree denoted $e_Q(r)$. The presented approach accepts any valid, sound method of calculating this evaluation, as long as the method is well-founded and $e_Q(r) \in \left[0,1\right]$.
\item
The evaluation of the temporal demand expressed in the temporal part, $Q^{time} = \left( I,AR \right)$, depends on $AR$. A specific construct of ill-known constraints (cf. section~\ref{iktc}) is considered, depending on the Allen relation denoted by $AR$. The exact construct of constraints is an instantiation based on the formulas which can be found in table \ref{table:const}, for every possible value of $AR$. The form and capacity of these constraints are based on~\cite{Pon11}. Then, using equations \eqref{eq:pos} and \eqref{eq:nec}, the exact formulas to calculate the possibility $\Pos_{Q^{time}}(r)$ and the necessity $\Nec_{Q^{time}}(r)$ that record $r$ satisfies this construct of ill-known time constraints are derived from this construct of constraints. As mentioned, $\Pos_{Q^{time}}(r)$ and $\Nec_{Q^{time}}(r)$ denote the possibility, respectively the necessity that the considered record $r$ satisfies the construct of constraints corresponding to the temporal demand $Q^{time}$ and thus the possibility, respectively the necessity that $r$ satisfies $Q^{time}$.


%The exact set of constraints is an instantiation based on the formulas which can be found in table \ref{tab:fuzzy-allen-relations}, for every possible value of $AR$. Then, using these formulas given in table \ref{tab:fuzzy-allen-relations}, both the possibility degree $\Pos_{Q^{time}}(r)$ and the necessity degree $\Nec_{Q^{time}}(r)$ are computed.
\end{itemize}

%\textcolor{red}{TODO: maybe part on what these pos and nec mean? Maybe part on where the formulas in table \ref{tab:fuzzy-allen-relations} come from?}

\begin{table}[h]
\caption{Constructs of constraints related to their respective Allen relations, as used in the presented work. In this table, the ill-known time interval $J = \left[X, Y\right]$ in a record $r$ has a start point described by possibilistic variable $X$ and an end point described by possibilistic variable $Y$. The crisp time interval in the user's temporal demand is denoted $I$.}

\centering
\begin{tabular}{|c|c|}
\hline
Allen Relation & Construct of constraints\\
\hline
I before J & $C_1 \triangleq \left(<,X\right)$ \\
\hline
I equal J & $\left(C_1 \triangleq \left(\geq,X\right)\right) \wedge \neg \left(C_2 \triangleq \left(\neq,X\right) \right) \wedge \left(C_3 \triangleq \left(\leq,Y\right) \right) \wedge \neg \left(C_4 \triangleq \left(\neq,Y\right)\right)$ \\
\hline
I meets J & $\left(C_1 \triangleq \left(\leq,X\right)\right) \wedge \neg \left(C_2 \triangleq \left(\neq,X\right) \right)$ \\
\hline
I overlaps J & $\left(C_1 \triangleq \left(<,Y\right)\right) \wedge \neg \left(C_2 \triangleq \left(\leq,X\right) \right) \wedge \neg \left(C_3 \triangleq \left(\geq,X\right) \right)$ \\
\hline
I during J & $\left( \left (C_1 \triangleq \left(>,X\right) \right) \wedge \left(C_2 \triangleq \left(\leq,Y\right) \right) \right) \vee \left( \left(C_3 \triangleq \left(\geq,X\right) \right) \wedge  \left(C_4 \triangleq \left(<,Y\right) \right) \right)$ \\
\hline
I starts J & $\left(C_1 \triangleq \left(\geq,X\right) \right) \wedge \neg \left(C_2\triangleq \left(\neq,X\right)\right)$ \\
\hline
I finishes J & $\left(C_1 \triangleq \left(\leq,Y\right) \right) \wedge \neg \left(C_2\triangleq \left(\neq,Y\right)\right)$ \\
\hline
\end{tabular}
\label{table:const}
\end{table}


%\begin{table}[h]

%\caption{Allen's relations used in the framework. Here, $I = \left[a, b\right]$ denotes a crisp time interval, $J = \left[X, Y\right]$ denotes an ill-known time interval, with $\pi_{X}$ and $\pi_{Y}$ the possibility distributions of $X$ and $Y$ respectively. The second column contains the corresponding formula to calculate the possibility that $I$ satisfies all constraints given by the Allen's relation.}

%\centering
%\begin{tabular}{|c|c|c|}
%\hline
%Allen Relation &  $\Pos\left(\text{I satisfies all constraints }C_{i}, i = 1,2,...\right)$ & $\Nec\left(C_{i}, i = 1,2,... \right)$ \\
%\hline
%I before J & $\sup_{a>w}\pi_X(w)$ & $\inf_{a \leq w} 1- \pi_X(w)$\\
%\hline

%\multirow{4}{*}
%{I equal J} &  $\min ( \sup_{a \leq w}\pi_X(w),$  & $\min ( \inf_{a>w} 1-\pi_X(w),$\\
%& $\pi_X(w),$ & $\inf_{w \in \left[a,b\right]} \pi_X(w), $ \\
% &  $\sup_{b \geq w}\pi_Y(w),$ & $\inf_{b>w} 1-\pi_Y(w),$\\
% & $\pi_Y(w))$ & $\inf_{w \in \left[a,b\right]} \pi_Y(w) )$ \\
%\hline

%\multirow{2}{*}
%I meets J  & $\min (\sup_{a\geq w} \pi_X(w),$ & $\min (\inf_{a<w} 1 - \pi_X(w),$\\
%& $\pi_X(w))$  & $ \inf_{w \in \left[a,b\right]} \pi_X(w) )$ \\
%\hline

%\multirow{3}{*}
%{I overlaps J}  & $\min ( \sup_{b>w}\pi_Y(w), $ & $\min ( \inf_{b \geq w} 1 - \pi_Y(w),$\\
% & $\sup_{a \geq w}\pi_X(w),$& $1- \inf_{a>w}1-\pi_X(w),$\\
% & $\sup_{a \leq w}\pi_X(w))$ & $1- \inf_{a<w}1-\pi_X(w) )$ \\
%\hline

%\multirow{4}{*}
%{I during J}  & $\max ( \min ( \sup_{a<w}\pi_X(w),,$ & $\max (\min (\inf_{a \leq w}1-\pi_X(w), $\\
% & $\sup_{b \geq w}\pi_Y(w)) $ & $ \inf_{b>w} 1- \pi_Y(w)),$ \\
% & $\min ( \sup_{a \leq w }\pi_X(w),$ & $\min ( \inf_{a<w}1-\pi_X(w),$\\
% & $\sup_{b>w}\pi_Y(w))$ & $\inf_{b\geq w}1-\pi_Y(w)))$ \\
%\hline
%\multirow{2}{*}
%{I starts J} &  $\min( \sup_{a \leq w}\pi_X(w),$  & $\min (\inf_{a<w}1-\pi_X(w),$\\
%& $\pi_X(w))$ & $inf_{w \in \left[a,b\right]} 1- \pi_X(w))$ \\
%\hline
%\multirow{2}{*}
%{I finishes J} &  $\min ( \sup_{b \geq w} \pi_Y(w),$  & $\min(\inf_{b>w}1-\pi_Y(w),$\\
%& $\pi_Y(w))$ & $\inf_{w \in [a,b]} 1- \pi_Y(w))$ \\
%\hline 

%\end{tabular}
%
%\vspace{10pt}
%
%
%\vspace{-25pt}
%\label{tab:fuzzy-allen-relations}
%\end{table}


%Thus, the evaluation of a query $\tilde{Q}$ for a record $r$ thus results in a satisfaction degree related to the non-temporal query demands and a couple of possibility and necessity related to the temporal demand. To be able to present the most appropriate results to the user most prominently, these evaluation results are aggregated and combined to result in a record rank.

\paragraph{\textbf{Aggregation and Ranking}} 
In this subsection, the notations used in the previous subsection are followed. To be able to present the most appropriate results to the user most prominently, for every record $r$, an aggregation method is used to aggregate $\Pos_{Q^{time}}(r)$ and $\Nec_{Q^{time}}(r)$ into a temporal record rank $e_{Q^{time}}(r)$ and after this, a convex combination combining $e_{Q^{time}}(r)$ and $e_{Q}(r)$ will provide the final record rank $e_{final}(r)$.

%For each temporal attribute $r_{time}$ for the record $r$, both possibility $\Pos \left( Q_{time}\right)$ and necessity $\Nec \left( Q_{time} \right)$ measures are obtained. Then, the measures are combined in order to obtain an evaluation score $e_{Q_{time} \left( r \right)}$. The evaluation function is computed by:

To calculate $e_{Q^{time}}(r)$, an a simple and crude method is used:

\begin{equation}
\label{eq:temporal-eval}
e_{Q^{time}}(r) = \left(\frac{\Pos_{Q^{time}}(r)+\Nec_{Q^{time}}(r)}{2}\right)
%e_{Q_{time} \left( r \right)} = \left \lbrace t \mid t = \left( \frac{\Pos \left( Q_{time}\right) + \Nec \left( Q_{time} \right)}{2} \right)   \in \left[ 0,1\right] \right \rbrace
\end{equation}

This method aims to provide the result records with a natural ranking based on the users temporal constraint. $e_{Q^{time}}(r)$ will of course be a value in $\left[0,1\right]$, as both $\Pos_{Q^{time}}(r) \in \left[0,1\right]$ and $\Nec_{Q^{time}}(r) \in \left[0,1\right]$. The purpose is that records which fit the users temporal demand better get a higher score than records fitting the temporal demand worse. Here, this aim is reached because the necessity degree $\Nec_{Q^{time}}(r)$ cannot exceed $0$ unless the possibility degree $\Pos_{Q^{time}}(r)$ equals $1$.

%This measure provides a natural score because of the following property of the necessity measure: 
%\begin{equation}
%\label{eq:necessity} %iff or iif?
%\Nec \left( Q_{time} \right) > 0  \Longleftrightarrow  \Pos \left( Q_{time}\right) = 1
%\end{equation}

The final ranking $e_{final}(r)$ for a record $r$ is now given by a convex combination of both temporal and non-temporal evaluation scores.

\begin{equation}
\label{eq:convex-combination}
e_{final} \left( r \right) = \omega \ast e_{Q} \left( r \right) + \left( 1- \omega \right) \ast e_{Q^{time}}
\end{equation}

A convex combination is used mainly for 2 reasons:
\begin{itemize}
	\item The use of this convex combination allows a record to make up for a low temporal evaluation score with a high non-temporal evaluation score and vice versa.
	\item The exact value of $\omega$ can now be modified to ascribe more value to either the fulfillment of the user's temporal demands or the fulfillment of the user's non-temporal constraints.
\end{itemize}

In the next subsection, some main concepts and issues concerning bipolarity in the context of temporal databases are presented and discussed.

\subsection{Bipolarity in Temporal Databases}
\label{subsubsec:bipolarity}
Humans express their preferences using both positive and negative statements, where positive statements express what is desired or acceptable and negative statements express what is undesired or unacceptable \cite{Billiet:Pons:Matthe:DeTre:Pons:2011:BipolarFuzzy}. This realization is interesting with regard to database querying, because sometimes a user does not exactly know his or her preferences or can't express them in only positive statements, but prefers to use negative statements to express what he or she dislikes or doesn't need. This introduces the need for \emph{bipolar querying}, a technique to model both positive and negative user preferences in a database query. Sometimes positive and negative preferences are clearly symmetric, making it possible to derive one from the other. For example, a person may define the concept of `tall' as `1.80 meters or higher'. The negative would then be the opposite: not tall would be `anyhing less than 1.80 meters'. However, in some cases, positive preferences can not be directly obtained from negative preferences or vice versa. E.g. when a person prefers to buy a black motorbike, this does not necessarily mean the person would totally reject a very dark blue motorbike. This phenomenon is called \emph{heterogeneous bipolarity}~\cite{Dubois2006},~\cite{Dubois2008}.

The use of imprecise query preference formulation in bipolar querying is well discussed in existing literature \cite{DeTre2009}, \cite{Dubois2008}, \cite{Lacroix87}. In \cite{Lacroix87}, desired and mandatory query conditions are used, instead of positive and negative preferences. However, the inverse of a mandatory preference expresses what should be rejected and this could be seen as negative information, whereas desired query conditions can be seen as positive preferences. However, the combination of bipolar querying and the use of imprecise query preferences in the context of temporal databases is not so well discussed in existing literature. A proposal for the bipolar querying of valid-time databases has been made by Billiet et al.~\cite{Billiet:Pons:Matthe:DeTre:Pons:2011:BipolarFuzzy}. The model presented there deals with a fuzzy valid-time specification based on~\cite{garrido2009}.

%Some previous work have been done in ~\cite{Lacroix87}. There, instead of positive and negative criteria, desired and mandatory query conditions are explained. This can be seen as a way to specify positive and negative information: the inverse of a mandatory condition is what should be rejected (negative information), whereas desired conditions can be seen as positive information.\\


%This introduces the necessity of a bipolar way of querying databases. Therefore, the bipolar querying of databases~\cite{DeTre2009} is a querying technique which allows the user to express both positive and negative criteria in the database query.\\

Bipolarity can be handled using different concepts, such as intuitionistic fuzzy sets~\cite{Atanassov1986}, interval valued fuzzy sets~\cite{Zadeh75a} Grattan-Guiness~\cite{Grattan76}, Janh~\cite{Jahn75}, Sambuc~\cite{Sambuc75},~\cite{Dubois05} or two fold fuzzy sets \cite{Dubois02}.

%\begin{itemize}
%\item
%Intuitionistic Fuzzy Sets~\cite{Atanassov1986} are sometimes used. The approach re-define the concept of inverse. Instead of considering the inverse of a set just the complementary, a AFS is defined by means of a membership function and a non-membership function.
%\item
%The interval valued fuzzy sets \emph{IVFS} were introduced independently by Zadeh~\cite{Zadeh75a}, Grattan-Guiness~\cite{Grattan76}, Janh~\cite{Jahn75}, Sambuc~\cite{Sambuc75} in the seventies~\cite{Dubois05}. %look for the reference!
%\item
%The two fold fuzzy sets \emph{(TFS)} by Dubois and Prade~\cite{Dubois02}. This approach defines desired and mandatory query conditions.
%\end{itemize}

From a theoretical point of view, bipolarity might be found either in the queries presented to a database system or in a database managed by a database system.

When bipolarity is found in queries, it is possible to distinguish between:
\begin{itemize}
	\item
	Bipolarity inside query criteria: each individual query criterion may be specified using both positive and negative preferences. For example when querying a car database, the user can express that he or she wants a black car, but definitely not a red neither a blue one. Bipolarity resides here within the car color criterion.
	\item
	Bipolarity outside query criteria: the query is specified using a global positive and a global negative preference part. For example when querying a car database, the user can express that he or she wants a black car, but definitely not a car with a fuel consumption of 6 liters or more.
	\end{itemize}

Concerning bipolarity inside a database, it should be possible to specify both positive and negative real world object or concept aspects, even at record level. Nevertheless, not so much research exists concerning bipolarity in databases.

%some attributes or even at tuple level it should be possible to specify them with bipolarity. Nevertheless, there is not so many research on this topic.
%	\begin{itemize}
%	\item
%	Attribute bipolarity: Each attribute may be specified  
%	\item
%	Tuple bipolarity:
%	\end{itemize}




%\paragraph{Query structure}
%The approach in this work follows the query specification given in \eqref{eq:query-specification}. The query has a global time demand, $Q^{time}$ and here, the regular query constraints specified by $Q$ are splitted into possitive and negative preferences:
%
%\begin{equation}
%\label{eq:bipolar-specification}
%\tilde{Q} = \left \lbrace Q^{time}, \left( Q^{pos}, Q^{neg} \right) \right \rbrace
%\end{equation}
%
%Here $Q^{pos}$ and $Q^{neg}$ represent the positive and the negative criteria, respectively. The temporal demand in $Q^{time}$ may be specified as in ~\cite{garrido2009} or as in ~ \cite{Pon11}, see section \ref{subsec:representation-time-intervals}.

%\paragraph{Query evaluation}
%As explained previously in the query evaluation section (\ref{subsubsec:query-evaluation}), each element in $\tilde{Q}$ is evaluated independently:
%
%\begin{itemize}
%\item
%The query $Q$ has now two elements: $Q^{pos}$ and $Q^{neg}$. Each element is again evaluated independently and the result is a tuple $\left(s,d \right)$ in which $s$ is the satisfaction degree for $Q^{pos}$. $d$ is called dissatisfaction degree for $Q^{neg}$. The tuple $\left(s,d \right) s,d \in \left[0,1 \right]$ is called \emph{Bipolar Satisfaction Degree}.
%\item
%The temporal specification is evaluated as explained in \ref{subsubsec:query-evaluation} and the result is a value in the unit interval.
%\end{itemize}
%
%\paragraph{Ranking}
%In order to present the results to the user, it is necessary to design a combination function. This function allows the classification of the results in the unit interval the preffered way is to made a convex combination as  presented in equation \eqref{eq:convex-combination}.
%

